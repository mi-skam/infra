# Development environment variables
---
# Less strict settings for development (but still no password auth)
ssh_password_authentication: false
ssh_permit_root_login: "yes"

# Development tools
additional_packages:
  - strace
  - tcpdump

# Backup configuration (for testing)
# Storage Box mount settings (loaded from secrets/backup.yaml)
storagebox_host: "{{ backup.storage_box_host }}"
storagebox_username: "{{ backup.storage_box_user }}"
storagebox_password: "{{ backup.storage_box_password }}"
storagebox_mount_point: "{{ backup.storage_box_mount_point }}"

# Restic backup settings (use different repo path for dev)
restic_repository_path: "/mnt/storagebox/restic-dev-backups"
restic_repository_password: "{{ backup.restic_repository_password }}"

# Backup schedule (for testing, run at 3am)
backup_schedule_time: "03:00"
backup_schedule_randomized_delay: "15m"

# Retention policy (shorter retention for dev)
backup_retention_daily: 3
backup_retention_weekly: 2
backup_retention_monthly: 1
backup_retention_yearly: 0

# Test backup paths (simple directories for dev testing)
backup_paths:
  - /etc/hostname
  - /etc/hosts
  - /var/log/syslog

# Backup exclusions
backup_exclude_patterns:
  - "*.tmp"
  - "*.cache"

# Monitoring configuration
# CRITICAL: srv-01 is NOT on Hetzner private network and requires VPN for connectivity
#
# Current Status:
# - node_exporter: ✅ Deployed and functional on test-1 (serving metrics at localhost:9100)
# - Promtail: ⚠️ Deployed but CANNOT connect to srv-01 (DNS resolution fails)
#
# Network Connectivity Issue:
# - srv-01 (local NixOS server) is not on Hetzner private network (10.0.0.0/16)
# - test-1.dev.nbg cannot resolve hostname "srv-01" (lookup fails on 127.0.0.53:53)
# - Promtail error: "dial tcp: lookup srv-01 on 127.0.0.53:53: server misbehaving"
#
# Required Action:
# 1. Deploy Tailscale or WireGuard VPN to create mesh network between srv-01 and Hetzner VPS
# 2. Update loki_url below with srv-01's Tailscale/VPN IP (e.g., "http://100.64.x.x:3100")
# 3. Re-run monitoring playbook after VPN is established:
#    cd ansible && ansible-playbook playbooks/monitoring.yaml --limit test-1.dev.nbg
#
# TODO: Replace hostname with Tailscale IP after VPN deployment
loki_url: "http://srv-01:3100"
node_exporter_port: 9100
promtail_port: 9080
monitoring_enable_firewall: true
