---
# Common role tasks

- name: Ensure system is up to date (Debian/Ubuntu)
  apt:
    upgrade: dist
    update_cache: true
    cache_valid_time: 3600
  when:
    - ansible_os_family == "Debian"
    - common_upgrade_dist | default(false) | bool

- name: Ensure system is up to date (RedHat)
  dnf:
    name: "*"
    state: latest
    update_cache: true
  when:
    - ansible_os_family == "RedHat"
    - common_upgrade_dist | default(false) | bool

- name: Create common directories
  file:
    path: "{{ item }}"
    state: directory
    mode: "{{ common_directory_mode }}"
  loop:
    - "{{ common_scripts_dir }}"
    - "{{ common_log_dir }}"

- name: Install useful shell aliases
  template:
    src: bash_aliases.j2
    dest: "{{ bash_aliases_path }}"
    owner: "{{ bash_aliases_owner }}"
    group: "{{ bash_aliases_group }}"
    mode: "{{ bash_aliases_mode }}"
